#!/bin/bash
# append /home/roowe/acm/bin to $PATH
ac_cc() {
    echo "compile $filepath"
    go build -o /tmp/$name $filepath
}
ac_run() {
    echo "run test /tmp/$name"
    data_list=`find $data_dir -name "*.in"`
    if [ "$data_list" = "" ]; then
        /tmp/$name
    else
        for data in $data_list; do
            echo "--------------------" $data "--------------------"
            /tmp/$name < $data
        done
    fi
}
help()
{
    echo "$0 cc problem.cpp"  
    echo "$0 run problem.cpp"
    echo "$0 test problem.cpp"
}
filepath=
if [ "$2" = "" ]; then
    filepath=`find . -name "*.go"`
else
    filepath=$2
fi
name=`basename $filepath .go`
data_dir=`dirname $filepath`
case $1 in
    'cc')
        ac_cc;;
    'run')
        ac_run;;
    'test')
        ac_cc && ac_run ;;
    *)
        ac_cc && ac_run ;;
esac
